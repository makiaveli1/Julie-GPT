{% extends 'base.html' %} {% load static %} {% block styles %}
<link
  rel="stylesheet"
  href="{% static 'css/style_chatbot.css' %}"
  type="text/css"
/>
{% endblock %} {% block content %}

<div>
  <!-- Replace the username with a button -->
  <div class="username-container">
    <button
      onclick="openProfilePopup()"
      class="btn btn-primary btn-md profile-btn"
      role="button"
    >
      Profile
    </button>
  </div>
  <!-- Profile Popup Content -->
  <div id="profile-popup" class="profile-popup" style="display: none">
    <form id="profile-form">
      <!-- Name -->
      <div class="form-group">
        <label for="user-full-name">Full Name:</label>
        <input type="text" id="user-full-name" name="full_name" required />
      </div>
      <!-- Email -->
      <div class="form-group">
        <label for="user-email">Email:</label>
        <input type="email" id="user-email" name="email" required />
      </div>
      <!-- Password Update -->
      <div class="form-group">
        <label for="user-password">Password:</label>
        <input type="password" id="user-password" name="password" />
        <small>Leave blank to keep the current password.</small>
      </div>
      <!-- Phone -->
      <div class="form-group">
        <label for="user-phone">Phone Number:</label>
        <input type="tel" id="user-phone" name="phone" />
      </div>
      <!-- Bio -->
      <div class="form-group">
        <label for="user-bio">Bio:</label>
        <textarea id="user-bio" name="bio"></textarea>
      </div>
      <!-- Profile Picture -->
      <div class="form-group">
        <label for="profile-picture">Profile Picture:</label>
        <input
          type="file"
          id="profile-picture"
          name="profile_picture"
          accept="image/*"
        />
      </div>
      <!-- Social Media Links -->
      <div class="form-group">
        <label for="user-social">Social Media Links:</label>
        <input type="url" id="user-social" name="social_media" />
      </div>
      <!-- Submit and Cancel Buttons -->
      <button type="submit" class="btn btn-primary">Save</button>
      <button
        type="button"
        class="btn btn-secondary"
        onclick="closeProfilePopup()"
      >
        Cancel
      </button>
    </form>
  </div>

  <!-- Position the auth buttons at the top right -->
  <div class="auth-buttons">
    {% if not user.is_authenticated %}
    <a href="{% url 'login' %}" class="btn btn-primary btn-md" role="button"
      >Login</a
    >
    {% else %}
    <a href="{% url 'logout' %}" class="btn btn-danger btn-md" role="button"
      >Logout</a
    >
    {% endif %}
  </div>
</div>
<div class="chatbox">
  <header>Talk to JULIE:</header>

  <div id="chat-container">
    <!-- Older messages can be loaded dynamically from here -->
    {% for chat in chats %}
    <div class="message user-message">
      <i class="fas fa-user avatar"></i>
      <span class="message-text">{{ chat.message|escape }}</span>
      <span class="timestamp">{{ chat.timestamp|date:"H:i" }}</span>
    </div>
    <div class="message chatbot-message">
      <img
        src="static\images\julie.jpg"
        alt="Julie"
        class="avatar chatbot-avatar"
      />
      <span class="message-text">{{ chat.response|escape }}</span>
      <span class="timestamp">{{ chat.timestamp|date:"H:i" }}</span>
    </div>
    {% endfor %}
    <!-- New messages will be appended here -->
  </div>

  <div class="input-container">
    <form method="post">
      {% csrf_token %}
      <input
        autofocus
        name="message"
        placeholder="Type a message..."
        type="text"
      />
      <button type="submit" class="send-btn">
        <i class="fas fa-paper-plane"></i>
        <!-- Font Awesome Paper Plane icon -->
      </button>
    </form>
  </div>
</div>
{% endblock %} {% block scripts %}
<script src="{% static 'js/script_chatbot.js' %}"></script>
{% endblock %}
